(this["webpackJsonpreact-social"]=this["webpackJsonpreact-social"]||[]).push([[18,7,35],{1154:function(e,t,n){"use strict";n.r(t);var a,o=n(15),i=n(8),r=n(43),s=n(49),l=n(45),c=n(86),d=n(48),p=n(178),u=n(292),m=n.n(u),h=n(154),g=n.n(h),f=n(645),b=n.n(f),v=n(0),y=n.n(v),O=n(106),E=n(95),C=n(607),w=n(633),x=n(61),j=n(102),S=n(39),P=n(17),k=n(50),T=n(33),I=n(539),N=n(19),L=function(e){return{search:function(t,n,a){return e(P.f.dbSearchPosts(t,n,a))},setHomeTitle:function(t){return e(P.d.setHeaderTitle(t||""))},showTopLoading:function(){return e(P.d.showTopLoading())},hideTopLoading:function(){return e(P.d.hideTopLoading())}}},R=function(){var e=S.a.selectCurrentUser(),t=j.b.selectHasMorePostSeach(),n=I.a.selectRequest(),a=j.b.selectSearchPosts();return function(o){var i=e(o).toJS(),r=k.a.createServerRequestId(T.a.SearchPosts,i.userId),s=n(o,{requestId:r}),l=t(o),c=a(o);return{hasMorePosts:l,currentUser:i,searchRequestStatus:s?s.status:N.a.NoAction,posts:c,requestId:r}}},D=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(s.a)(this,Object(l.a)(t).call(this,e))).unlisten=void 0,n.currentPage=0,n.searchParam=function(){return b.a.parse(window.location.search).q},n.state={},n.searchQuery=n.searchQuery.bind(Object(c.a)(n)),n.executeSearch=n.executeSearch.bind(Object(c.a)(n)),n.searchParam=n.searchParam.bind(Object(c.a)(n)),n}return Object(d.a)(t,e),Object(r.a)(t,[{key:"searchQuery",value:function(){var e=this.props.location;this.executeSearch(e)}},{key:"executeSearch",value:function(e){(0,this.props.search)(b.a.parse(e.search).q,this.currentPage,10),this.currentPage++}},{key:"componentDidMount",value:function(){var e=this,t=this.props.history,n=this;this.unlisten=t.listen((function(t){n.currentPage=0,e.executeSearch(t)}))}},{key:"componentWillUnmount",value:function(){this.unlisten()}},{key:"render",value:function(){var e=this.props,t=e.t,n=e.classes,a=e.posts,i=e.hasMorePosts,r=e.requestId;return y.a.createElement(w.default,{tab:"posts"},y.a.createElement("div",{id:"stream-parent",className:g()(Object(o.a)({},n.noDisplay,a.isEmpty()))},y.a.createElement(C.a,{posts:a,requestId:r,loadStream:this.searchQuery,hasMorePosts:i,displayWriting:!1})),y.a.createElement("div",{className:g()(Object(o.a)({},n.noDisplay,!a.isEmpty()))},y.a.createElement(p.a,{className:n.notFound},t("search.notFoundPost",{query:this.searchParam()}))))}}]),t}(v.Component),W=Object(O.c)("translations")(D),M=Object(E.withRouter)((a=m()((function(e){return{banner:Object(o.a)({backgroundAttachment:"scroll",borderRadius:"2px",backgroundRepeat:"unset !important",backgroundPosition:"center center !important"},e.breakpoints.down("xs"),{backgroundAttachment:"scroll",height:"220px !important"}),bannerContainer:Object(o.a)({height:384},e.breakpoints.down("xs"),{height:"260px !important"}),media:{height:0,paddingTop:"56.25%"},noDisplay:{display:"none"},notFound:{textAlign:"center",fontSize:18,fontWeight:300,color:"rgba(152, 150, 150, 0.87)"}}}))(W),Object(x.connect)(R,L)(a)));t.default=M},551:function(e,t,n){"use strict";var a=n(8),o=n(43),i=n(49),r=n(45),s=n(48),l=n(631),c=n(521),d=n(0),p=n.n(d),u=function(e){function t(){return Object(a.a)(this,t),Object(i.a)(this,Object(r.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props.theme;return p.a.createElement("div",{key:"load-more-progress",className:"g-load-more"},p.a.createElement(c.a,{size:30,thickness:5,style:{color:e.palette.primary.light}}))}}]),t}(d.Component),m=Object(l.a)(u);t.a=m},554:function(e,t,n){"use strict";var a=n(0),o=n.n(a),i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};var r=function(){return(r=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};var s={Pixel:"Pixel",Percent:"Percent"},l={unit:s.Percent,value:.8};var c=function(e){function t(t){var n=e.call(this,t)||this;return n.lastScrollTop=0,n.actionTriggered=!1,n.startY=0,n.currentY=0,n.dragging=!1,n.maxPullDownDistance=0,n.getScrollableTarget=function(){return n.props.scrollableTarget instanceof HTMLElement?n.props.scrollableTarget:"string"===typeof n.props.scrollableTarget?document.getElementById(n.props.scrollableTarget):(null===n.props.scrollableTarget&&console.warn("You are trying to pass scrollableTarget but it is null. This might\n        happen because the element may not have been added to DOM yet.\n        See https://github.com/ankeetmaini/react-infinite-scroll-component/issues/59 for more info.\n      "),null)},n.onStart=function(e){n.lastScrollTop||(n.dragging=!0,e instanceof MouseEvent?n.startY=e.pageY:e instanceof TouchEvent&&(n.startY=e.touches[0].pageY),n.currentY=n.startY,n._infScroll&&(n._infScroll.style.willChange="transform",n._infScroll.style.transition="transform 0.2s cubic-bezier(0,0,0.31,1)"))},n.onMove=function(e){n.dragging&&(e instanceof MouseEvent?n.currentY=e.pageY:e instanceof TouchEvent&&(n.currentY=e.touches[0].pageY),n.currentY<n.startY||(n.currentY-n.startY>=Number(n.props.pullDownToRefreshThreshold)&&n.setState({pullToRefreshThresholdBreached:!0}),n.currentY-n.startY>1.5*n.maxPullDownDistance||n._infScroll&&(n._infScroll.style.overflow="visible",n._infScroll.style.transform="translate3d(0px, "+(n.currentY-n.startY)+"px, 0px)")))},n.onEnd=function(){n.startY=0,n.currentY=0,n.dragging=!1,n.state.pullToRefreshThresholdBreached&&n.props.refreshFunction&&n.props.refreshFunction(),requestAnimationFrame((function(){n._infScroll&&(n._infScroll.style.overflow="auto",n._infScroll.style.transform="none",n._infScroll.style.willChange="none")}))},n.onScrollListener=function(e){"function"===typeof n.props.onScroll&&setTimeout((function(){return n.props.onScroll&&n.props.onScroll(e)}),0);var t=n.props.height||n._scrollableNode?e.target:document.documentElement.scrollTop?document.documentElement:document.body;n.actionTriggered||(n.isElementAtBottom(t,n.props.scrollThreshold)&&n.props.hasMore&&(n.actionTriggered=!0,n.setState({showLoader:!0}),n.props.next&&n.props.next()),n.lastScrollTop=t.scrollTop)},n.state={showLoader:!1,pullToRefreshThresholdBreached:!1},n.throttledOnScrollListener=function(e,t,n,a){var o,i=!1,r=0;function s(){o&&clearTimeout(o)}function l(){var l=this,c=Date.now()-r,d=arguments;function p(){r=Date.now(),n.apply(l,d)}i||(a&&!o&&p(),s(),void 0===a&&c>e?p():!0!==t&&(o=setTimeout(a?function(){o=void 0}:p,void 0===a?e-c:e)))}return"boolean"!==typeof t&&(a=n,n=t,t=void 0),l.cancel=function(){s(),i=!0},l}(150,n.onScrollListener).bind(n),n.onStart=n.onStart.bind(n),n.onMove=n.onMove.bind(n),n.onEnd=n.onEnd.bind(n),n}return function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t.prototype.componentDidMount=function(){var e=this;if(this._scrollableNode=this.getScrollableTarget(),this.el=this.props.height?this._infScroll:this._scrollableNode||window,this.el&&this.el.addEventListener("scroll",(function(t){return e.throttledOnScrollListener(t)})),"number"===typeof this.props.initialScrollY&&this.el&&this.el instanceof HTMLElement&&this.el.scrollHeight>this.props.initialScrollY&&this.el.scrollTo(0,this.props.initialScrollY),this.props.pullDownToRefresh&&this.el&&(this.el.addEventListener("touchstart",this.onStart),this.el.addEventListener("touchmove",this.onMove),this.el.addEventListener("touchend",this.onEnd),this.el.addEventListener("mousedown",this.onStart),this.el.addEventListener("mousemove",this.onMove),this.el.addEventListener("mouseup",this.onEnd),this.maxPullDownDistance=this._pullDown&&this._pullDown.firstChild&&this._pullDown.firstChild.getBoundingClientRect().height||0,this.forceUpdate(),"function"!==typeof this.props.refreshFunction))throw new Error('Mandatory prop "refreshFunction" missing.\n          Pull Down To Refresh functionality will not work\n          as expected. Check README.md for usage\'')},t.prototype.componentWillUnmount=function(){var e=this;this.el&&(this.el.removeEventListener("scroll",(function(t){return e.throttledOnScrollListener(t)})),this.props.pullDownToRefresh&&(this.el.removeEventListener("touchstart",this.onStart),this.el.removeEventListener("touchmove",this.onMove),this.el.removeEventListener("touchend",this.onEnd),this.el.removeEventListener("mousedown",this.onStart),this.el.removeEventListener("mousemove",this.onMove),this.el.removeEventListener("mouseup",this.onEnd)))},t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.props.key===e.key&&this.props.dataLength===e.dataLength||(this.actionTriggered=!1,this.setState({showLoader:!1,pullToRefreshThresholdBreached:!1}))},t.prototype.isElementAtBottom=function(e,t){void 0===t&&(t=.8);var n=e===document.body||e===document.documentElement?window.screen.availHeight:e.clientHeight,a=function(e){return"number"===typeof e?{unit:s.Percent,value:100*e}:"string"===typeof e?e.match(/^(\d*(\.\d+)?)px$/)?{unit:s.Pixel,value:parseFloat(e)}:e.match(/^(\d*(\.\d+)?)%$/)?{unit:s.Percent,value:parseFloat(e)}:(console.warn('scrollThreshold format is invalid. Valid formats: "120px", "50%"...'),l):(console.warn("scrollThreshold should be string or number"),l)}(t);return a.unit===s.Pixel?e.scrollTop+n>=e.scrollHeight-a.value:e.scrollTop+n>=a.value/100*e.scrollHeight},t.prototype.render=function(){var e=this,t=r({height:this.props.height||"auto",overflow:"auto",WebkitOverflowScrolling:"touch"},this.props.style),n=this.props.hasChildren||!!(this.props.children&&this.props.children instanceof Array&&this.props.children.length),a=this.props.pullDownToRefresh&&this.props.height?{overflow:"auto"}:{};return o.a.createElement("div",{style:a,className:"infinite-scroll-component__outerdiv"},o.a.createElement("div",{className:"infinite-scroll-component "+(this.props.className||""),ref:function(t){return e._infScroll=t},style:t},this.props.pullDownToRefresh&&o.a.createElement("div",{style:{position:"relative"},ref:function(t){return e._pullDown=t}},o.a.createElement("div",{style:{position:"absolute",left:0,right:0,top:-1*this.maxPullDownDistance}},this.state.pullToRefreshThresholdBreached?this.props.releaseToRefreshContent:this.props.pullDownToRefreshContent)),this.props.children,!this.state.showLoader&&!n&&this.props.hasMore&&this.props.loader,this.state.showLoader&&this.props.hasMore&&this.props.loader,!this.props.hasMore&&this.props.endMessage))},t}(a.Component);t.a=c},569:function(e,t,n){"use strict";var a=n(559),o=n(15),i=n(8),r=n(43),s=n(49),l=n(45),c=n(86),d=n(48),p=n(800),u=n(1128),m=n(1135),h=n(1129),g=n(177),f=n(1114),b=n(1117),v=n(1116),y=n(1115),O=n(696),E=n(780),C=n(524),w=n(279),x=n(1112),j=n(16),S=n(522),P=n(534),k=n(178),T=n(552),I=n.n(T),N=n(546),L=n.n(N),R=n(571),D=n.n(R),W=n(585),M=n.n(W),A=n(655),U=n.n(A),z=n(656),B=n.n(z),V=n(657),F=n.n(V),q=n(553),G=n(53),Y=n(50),H=n(154),_=n.n(H),X=n(0),J=n.n(X),Q=n(61),$=n(22),Z=n(106),K=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(s.a)(this,Object(l.a)(t).call(this,e))).handleAddLink=function(){var e=n.props,t=e.onAddLink,a=e.onClose,o=n.state.link;o&&""!==o.trim()&&t(o,Y.a.validateYoutubeUrl(o)?Y.a.getYoutubetThumbnails(o):$.a.settings.defaultVideoThumbnails);a()},n.handleInputChange=function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,i=t.name;"link"===i&&n.validateInputLink(a),n.setState(Object(o.a)({},i,a))},n.validateInputLink=function(e){var t=n.props.t;e&&""!==e.trim()?Y.a.validateUrl(e.trim())?n.setState({linkInputError:"",disabledOk:!1}):n.setState({linkInputError:t("post.videoInputLinkInvalidError"),disabledOk:!0}):n.setState({linkInputError:t("post.videoInputLinkRequiredError"),disabledOk:!0})},n.state={link:"",linkInputError:"",disabledOk:!0},n}return Object(d.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.t,a=e.open,o=e.onClose,i=this.state,r=i.disabledOk,s=i.linkInputError;return J.a.createElement(f.a,{PaperProps:{className:t.fullPageXs},open:a,onClose:o,maxWidth:"md"},J.a.createElement(y.a,null,n("post.addVideoTitle")),J.a.createElement(v.a,null,J.a.createElement(S.a,{autoFocus:!0,margin:"dense",type:"link",name:"link",onChange:this.handleInputChange,helperText:s,error:""!==s,fullWidth:!0})),J.a.createElement(b.a,null,J.a.createElement(p.a,{color:"primary",disableFocusRipple:!0,disableRipple:!0,onClick:o,style:{color:g.a[800]}},n("post.cancelButton")),J.a.createElement(p.a,{color:"primary",disableFocusRipple:!0,disableRipple:!0,onClick:this.handleAddLink,disabled:r},n("post.addVideoButton"))))}}]),t}(X.Component),ee=Object(Z.c)("translations")(K),te=Object(Q.connect)((function(e,t){return{}}),(function(e,t){return{}}))(Object(j.a)((function(e){return{fullPageXs:Object(o.a)({},e.breakpoints.down("xs"),{width:"100%",height:"100%",margin:0,overflowY:"auto"}),dialogTitle:{padding:0}}}))(ee)),ne=n(608),ae=n(544),oe=n(1120),ie=n(1118),re=n(1119),se=n(532),le=n(556),ce=n.n(le),de=n(33),pe=n(135),ue=n(1150),me=n(5),he=n(46),ge=n(19),fe=n(39),be=n(539),ve=n(547),ye=n.n(ve),Oe=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(s.a)(this,Object(l.a)(t).call(this,e))).saveAlbum=function(){var e=n.props,t=e.progress,o=e.t,i=e.currentUser,r=n.state,s=r.accessUserList,l=r.permission,c=(Y.a.isEmpty(n.state.albumName)?o("album.defaultAlbumName"):n.state.albumName,Object(a.a)(n.state.selectedPhotos)),d=[];c.slice(0,4).map((function(e){var n=t.getIn([e.fileName,"meta"],{url:""}),a=e.fileName.split(".")[0],o=new pe.a(a,0,0,n.url||URL.createObjectURL(e.src),n.url||URL.createObjectURL(e.src),e.fileName,"","",e.fileName,i.userId,0,"",0,0,"",!1,s,l);return d.push(o),{url:n.url,fileName:e.fileName,fileId:a}}))},n.deleteSelectedPhoto=function(e){var t=n.props.onDelete,o=Object(a.a)(n.state.selectedPhotos);o=o.filter((function(t){return t.fileName!==e})),n.setState({selectedPhotos:o}),t(e)},n.imageList=function(){var e=n.props,t=e.classes,a=e.progress;return n.state.selectedPhotos.map((function(e){var o=a.getIn([e.fileName,"percent"],0),i=a.getIn([e.fileName,"visible"],!1);return J.a.createElement(ie.a,{key:"album-dialog-tile-".concat(e.fileName)},J.a.createElement("img",{src:e.src,alt:"something"}),J.a.createElement(re.a,{title:i?J.a.createElement(se.a,{variant:"determinate",value:o,color:"secondary"}):"",actionIcon:i?"":J.a.createElement(C.a,{className:t.icon,onClick:function(){return n.deleteSelectedPhoto(e.fileName)}},J.a.createElement(ce.a,null))}))}))},n.gridTile=function(){var e=n.props.classes;return J.a.createElement(oe.a,{cellHeight:100,className:e.gridList,cols:3},n.imageList())},n.state={selectedPhotos:[],prevPhotos:[]},n.imageList=n.imageList.bind(Object(c.a)(n)),n.deleteSelectedPhoto=n.deleteSelectedPhoto.bind(Object(c.a)(n)),n.saveAlbum=n.saveAlbum.bind(Object(c.a)(n)),n}return Object(d.a)(t,e),Object(r.a)(t,null,[{key:"getDerivedStateFromProps",value:function(e,t){return ue.a(e.photos,t.prevPhotos)?null:{selectedPhotos:Object(a.a)(e.photos),prevPhotos:e.photos}}}]),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.classes;return J.a.createElement("div",{className:e.root},this.gridTile())}}]),t}(X.Component),Ee=Object(Z.c)("translations")(Oe),Ce=Object(j.a)((function(e){return{fullPageXs:{},root:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",overflow:"hidden",backgroundColor:e.palette.background.paper,marginTop:30},gridList:{flexWrap:"nowrap",width:"100%",transform:"translateZ(0)"},icon:{color:"rgba(255, 255, 255, 0.54)"},header:{display:"flex",alignItems:"center",height:50,paddingLeft:e.spacing(4),marginBottom:20,backgroundColor:e.palette.background.default},paper:Object(o.a)({minHeight:"500px"},e.breakpoints.down("xs"),{width:"100%",height:"100%",maxHeight:"100%",maxWidth:"100%",borderRadius:0,margin:0}),information:{display:"flex",flexDirection:"column",padding:20},buttonProgress:{color:ye.a[500],position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12},wrapper:{margin:e.spacing(1),position:"relative"}}}),{withTheme:!0})(Ee),we=Object(Q.connect)((function(){var e=fe.a.selectCurrentUser(),t=be.a.selectRequest();return function(n,a){var o=e(n).toJS(),i=Y.a.createServerRequestId(de.a.GalleryCreateAlbum,o.userId),r=t(n,{requestId:i});return{currentUser:o,createAlbumRequestStatus:r?r.status:ge.a.NoAction}}}),(function(e,t){return{deleteImage:function(t,n){return e(he.dbDeleteImage(t,$.a.data.imageFolderPath,n))},progressChange:function(t,n){return e(me.progressChange(t,n))}}}))(Ce),xe=n(202),je=n(593),Se=n(1134),Pe=n(654),ke=n.n(Pe),Te=n(4),Ie=n(52),Ne=n(122),Le=n.n(Ne),Re=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(s.a)(this,Object(l.a)(t).call(this,e))).styles={root:{display:"flex",flexWrap:"wrap",justifyContent:"space-around"},uploadButton:{verticalAlign:"middle",fontWeight:400},uploadInput:{cursor:"pointer",position:"absolute",top:0,bottom:0,right:0,left:0,width:"100%",opacity:0},deleteVideo:{marginLeft:"5px",cursor:"pointer",color:"white"},addImage:{marginRight:"5px",cursor:"pointer",color:"white"}},n.fileInputRef=void 0,n.videoRef=void 0,n.blobFile=void 0,n.file=void 0,n.handleSetVideo=function(e,t,a){n.props.set(t,a),n.close()},n.togglePreview=function(){n.setState((function(e,t){return e.isPreview&&(n.fileInputRef.current.value=""),{isPreview:!e.isPreview}}))},n.handleDeleteVideo=function(e,t){n.props.deleteVideo(t)},n.onFileChange=function(e){var t=n.props,a=t.showError,o=t.t,i=q.a.getExtension(e.target.files[0].name),r=!1;q.a.checkMaxFileSize(e.target.files[0].size,$.a.settings.maxVideoFileSize)&&(r=!0,a(o("videGallery.maxExceedMessage")));var s="".concat(Le()(),".").concat(i);n.setState({isPreview:!0,fileName:s,isSaveDisabled:r}),n.file=e.currentTarget.files[0];var l=n.file.type,c=n.videoRef.current,d=c.canPlayType(l);""===d&&(d="no");var p=URL.createObjectURL(n.file);c.src=p},n.close=function(){n.props.close()},n.videoList=function(){return n.props.videos.map((function(e,t){return J.a.createElement(ie.a,{key:e.id},J.a.createElement("div",null,J.a.createElement("div",{style:{overflowY:"hidden",overflowX:"auto"}},J.a.createElement("ul",{style:{whiteSpace:"nowrap",padding:"0 6px",margin:"8px 0 0 0",verticalAlign:"bottom",flexShrink:0,listStyleType:"none"}},J.a.createElement("div",{style:{display:"block"}},J.a.createElement("div",{style:{display:"block",marginRight:"8px",transition:"transform .25s"}},J.a.createElement("li",{style:{width:"100%",margin:0,verticalAlign:"bottom",position:"static",display:"inline-block"}},J.a.createElement(ae.a,{fileName:e.thumbnail,style:{width:"100%",height:"auto"}}))))))),J.a.createElement(re.a,{title:J.a.createElement(ce.a,{style:n.styles.deleteVideo,onClick:function(t){return n.handleDeleteVideo(t,e.id)}}),titlePosition:"top",actionIcon:J.a.createElement(ke.a,{style:n.styles.addImage,onClick:function(t){return n.handleSetVideo(t,e.URL,e.thumbnail)}}),actionPosition:"left"}))}))},n.handleUploadVideo=function(){var e=n.props.uploadVideo,t=n.state.fileName;q.a.captureVideo(n.videoRef.current,null).toBlob((function(a){e(n.file,t,a),n.togglePreview()}),"image/jpeg",.95)},n.state={fileName:"",isPreview:!1,isSaveDisabled:!1},n.fileInputRef=J.a.createRef(),n.videoRef=J.a.createRef(),n.close=n.close.bind(Object(c.a)(n)),n.onFileChange=n.onFileChange.bind(Object(c.a)(n)),n.handleSetVideo=n.handleSetVideo.bind(Object(c.a)(n)),n.handleDeleteVideo=n.handleDeleteVideo.bind(Object(c.a)(n)),n.videoList=n.videoList.bind(Object(c.a)(n)),n.handleUploadVideo=n.handleUploadVideo.bind(Object(c.a)(n)),n}return Object(d.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.getVideoGallery;e&&e()}},{key:"render",value:function(){var e=this.props,t=e.t,n=e.videos,a=e.classes,i=this.state,r=i.isPreview,s=i.isSaveDisabled,l=J.a.createElement(oe.a,{cellHeight:180,className:_()(a.gridList,Object(o.a)({},a.noDisplay,r))},J.a.createElement(ie.a,{key:"upload-image-gallery"},J.a.createElement("div",{style:{display:"flex",backgroundColor:"rgba(222, 222, 222, 0.52)",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%"}},J.a.createElement("input",{accept:"video/mp4,video/x-m4v,video/*",style:this.styles.uploadInput,id:"raised-button-file",onChange:this.onFileChange,ref:this.fileInputRef,type:"file"}),J.a.createElement("label",{htmlFor:"raised-button-file"},J.a.createElement(p.a,{variant:"contained",component:"span",style:this.styles.uploadButton},t("imageGallery.uploadButton"))))),n&&n.count()>0?this.videoList():""),c=J.a.createElement("div",{className:_()(a.videoRoot,Object(o.a)({},a.noDisplay,!r))},J.a.createElement("video",{className:_()(a.video),controls:!0,autoPlay:!1,ref:this.videoRef}));return J.a.createElement("div",{style:this.styles.root},J.a.createElement(Se.a,{in:!r},l),J.a.createElement(Se.a,{in:r},c),J.a.createElement("div",{className:_()(a.previewActions,Object(o.a)({},a.noDisplay,!r))},J.a.createElement(p.a,{disabled:s,color:"primary",onClick:this.handleUploadVideo}," ",t("videGallery.saveButton")," "),J.a.createElement(p.a,{onClick:this.togglePreview}," ",t("videGallery.backButton")," ")))}}]),t}(X.Component),De=Object(Z.c)("translations")(Re),We=Object(Q.connect)((function(e){var t=e.getIn(["authorize","uid"]),n=Ie.a.getUserProfileById(e,{userId:t}).toJS();return{videos:e.getIn(["imageGallery","videos"],Object(Te.Map)({})),avatar:n?n.avatar:""}}),(function(e,t){return{uploadVideo:function(t,n,a){return e(he.dbUploadVideo(t,n,a))},deleteVideo:function(t){return e(he.dbDeletedVideo(t))},getVideoGallery:function(){return e(he.dbGetVideoGallery())},showError:function(t){return e(me.showMessage(t))}}}))(Object(j.a)((function(e){return{fullPageXs:Object(o.a)({},e.breakpoints.down("xs"),{width:"100%",height:"100%",margin:0,overflowY:"auto"}),gridList:{width:500,height:450,overflowY:"auto"},noDisplay:{display:"none !important"},video:{width:"100%",height:"100%",position:"absolute",top:0,left:0},videoRoot:{position:"relative",padding:"39.25%",width:"100%",height:"100%"},previewActions:{justifyContent:"space-between",display:"flex",marginTop:10,width:"100%",height:"100%"}}}))(De)),Me=n(80),Ae=n(584),Ue=n(204),ze=n(47),Be=n(181),Ve=n(133),Fe=function(e,t){return{openAlbum:function(){return e(me.openDialog(Be.a.Album))},closeAlbum:function(){return e(me.closeDialog(Be.a.Album))},post:function(t,n){return e(ze.dbAddPost(t,n))},update:function(t,n){return e(ze.dbUpdatePost(t,n))},uploadImage:function(t,n){return e(he.dbUploadImage(t,n))}}},qe=function(){var e=fe.a.selectCurrentUser(),t=Ve.a.selectDialogState(),n=Ve.a.selectProgress();return function(a,o){var i=e(a).toJS(),r=t(a,{type:Be.a.Album}),s=n(a);return{postImageState:a.getIn(["imageGallery","status"]),ownerAvatar:i.avatar||"",ownerDisplayName:i.fullName||"",albumDialogOpen:r,progress:s}}},Ge=n(527);function Ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function He(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ye(n,!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ye(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _e,Xe=function(e){function t(e){var n;Object(i.a)(this,t),(n=Object(s.a)(this,Object(l.a)(t).call(this,e))).selectedPhotos=[],n.handleToggleComments=function(){n.setState((function(e,t){return{disableSharing:!e.disableComments,disabledPost:!n.isPostChangeValid(e)}}))},n.handleToggleSharing=function(){n.setState((function(e,t){return{disableSharing:!e.disableSharing,disabledPost:!n.isPostChangeValid(e)}}))},n.handleTogglePermission=function(){n.setState((function(e,t){return{permissionOpen:!e.permissionOpen,disabledPost:!n.isPostChangeValid(e)}}))},n.handleRemoveImage=function(){n.setState((function(e,t){return{image:"",video:"",imageFullPath:"",postType:Ue.a.Text,disabledPost:!n.isPostChangeValid(e)}}))},n.closeAlbumDialog=function(){var e=n.props.closeAlbum;e&&e()},n.openAlbumDialog=function(){var e=n.props.openAlbum;e&&e()},n.handlePost=function(){n.setState({disabledPost:!1});var e=n.state,t=e.image,a=e.imageFullPath,o=e.disableComments,i=e.disableSharing,r=e.postText,s=e.video,l=e.thumbnail,c=e.postType,d=e.accessUserList,p=e.permission,u=e.galleryOpen,m=e.selectedPhotos,h=n.props,g=h.ownerAvatar,f=h.ownerDisplayName,b=h.edit,v=h.onRequestClose,y=h.post,O=h.update,E=h.postModel,C=h.progress;if(n.isPostChangeValid(n.state)){var w=G.b(r),x=new Ae.a;u&&m.forEach((function(e){var t=C.getIn([e.fileName,"meta"]),n=(e.fileName.split(".")[0],e.fileName,"");n=t?t.url:e.src,x.photos.push(n)}));var j={body:r,tags:w,image:t,video:s,thumbnail:l,imageFullPath:a,ownerAvatar:g,ownerDisplayName:f,disableComments:o,disableSharing:i,postTypeId:c,score:0,album:He({},x),viewCount:0,accessUserList:d,permission:p};if(b)O(E.set("body",r).set("tags",Object(Te.List)(w)).set("image",t).set("imageFullPath",a).set("video",s).set("album",Object(Te.fromJS)(He({},x))).set("thumbnail",l).set("disableComments",o).set("disableSharing",i).set("postTypeId",c).set("accessUserList",Object(Te.List)(d)).set("permission",p),v);else y(j,v)}else n.setState({disabledPost:!0})},n.onRequestSetImage=function(e){n.setState({image:e,video:"",postType:Ue.a.Photo,disabledPost:!1})},n.onSetVideo=function(e,t){n.setState({image:"",thumbnail:t,video:e,postType:Ue.a.Video,disabledPost:!1})},n.handleOnChange=function(e){var t=e.target.value;n.setState({postText:t}),0===t.length||""===t.trim()||n.props.edit&&t.trim()===n.props.text?n.setState({postText:t,disabledPost:!0}):n.setState({postText:t,disabledPost:!1})},n.handleCloseGallery=function(){n.setState({galleryOpen:!1})},n.handleOpenGallery=function(){n.setState({galleryOpen:!0})},n.handleOpenVideoLink=function(){n.setState({videoLinkOpen:!0})},n.handleCloseVideoLink=function(){n.setState({videoLinkOpen:!1})},n.handleOpenVideoGallery=function(){n.setState({videoGalleryOpen:!0})},n.handleCloseVideoGallery=function(){n.setState({videoGalleryOpen:!1})},n.handleOpenMenu=function(e){n.setState({menuOpen:!0,menuAnchorEl:e.currentTarget})},n.handleCloseMenu=function(){n.setState({menuOpen:!1,menuAnchorEl:null})},n.handleAccessList=function(e,t){n.setState({accessUserList:e,permission:t,permissionOpen:!1})},n.handleDeletePhoto=function(e){var t=n.state,a=t.selectedPhotos,o=t.postText,i=[];a.forEach((function(t){e!==t.fileName&&i.push(t)}));var r=!0,s=0===o.length||""===o.trim()||n.props.edit&&o.trim()===n.props.text;(i&&i.length>0||!s)&&(r=!1),n.setState({selectedPhotos:[].concat(i),disabledPost:r})},n.onUploadAlbumChange=function(e){var t=n.props.uploadImage,o=n.state,i=o.galleryOpen,r=o.selectedPhotos;if(t){for(var s=e.currentTarget.files,l=[],c=0;c<s.length;c++){var d=s[c],p=q.a.getExtension(d.name),u="".concat(Le()(),".").concat(p);l.push({src:URL.createObjectURL(d),fileName:u}),t(d,u)}var m=[].concat(Object(a.a)(r),l);s.length>3&&!i?(n.selectedPhotos=m.map((function(e){return{file:e.src,fileName:e.fileName}})),n.openAlbumDialog()):n.setState({selectedPhotos:Object(a.a)(m),galleryOpen:!0,disabledPost:!1,postType:Ue.a.PhotoGallery}),e.currentTarget.value=null}},n.isPostChangeValid=function(e){var t=e.image,n=e.video,a=e.postText,o=e.selectedPhotos;return!Y.a.isEmpty(t)||!Y.a.isEmpty(n)||!Y.a.isEmpty(a)||o&&o.length>0},n.getPermissionLabel=function(){var e=n.props.t,t=n.state.permission,a="";return t===Me.a.Public?a=e("permission.public"):t===Me.a.Circles?a=e("permission.circles"):t===Me.a.OnlyMe&&(a=e("permission.onlyMe")),a};var o=e.postModel,r=o&&o.getIn(["album","photos"],Object(Te.List)([])),d=e.edit&&o&&o.get("postTypeId",0)===Ue.a.PhotoGallery?r.map((function(e){return Object(Te.Map)({src:e,fileName:e,loaded:!0})})).toJS():[],p=!!(n.props.edit&&d&&d.length>0);return n.state={postText:n.props.edit&&o?o.get("body",""):"",image:n.props.edit&&o?o.get("image",""):"",imageFullPath:n.props.edit&&o?o.get("imageFullPath",""):"",galleryOpen:p,menuOpen:!1,disabledPost:!0,disableComments:!(!n.props.edit||!o)&&o.get("disableComments",!1),disableSharing:!(!n.props.edit||!o)&&o.get("disableSharing",!1),videoLinkOpen:!1,videoGalleryOpen:!1,permissionOpen:!1,video:n.props.edit&&o?o.get("video",""):"",thumbnail:n.props.edit&&o?o.get("thumbnail",""):"",postType:n.props.edit&&o?o.get("postTypeId",Ue.a.Text):Ue.a.Text,accessUserList:n.props.edit&&o?o.get("accessUserList",[]):[],permission:n.props.edit&&o?o.get("permission",Me.a.Public):Me.a.Public,selectedPhotos:d,album:n.props.edit&&o?o.get("album",Object(Te.Map)({photos:Object(Te.List)([])})):Object(Te.Map)({photos:Object(Te.List)([])})},n.handleOnChange=n.handleOnChange.bind(Object(c.a)(n)),n.handleCloseGallery=n.handleCloseGallery.bind(Object(c.a)(n)),n.handleOpenGallery=n.handleOpenGallery.bind(Object(c.a)(n)),n.onRequestSetImage=n.onRequestSetImage.bind(Object(c.a)(n)),n.handlePost=n.handlePost.bind(Object(c.a)(n)),n.handleRemoveImage=n.handleRemoveImage.bind(Object(c.a)(n)),n.handleToggleComments=n.handleToggleComments.bind(Object(c.a)(n)),n.handleToggleSharing=n.handleToggleSharing.bind(Object(c.a)(n)),n.handleTogglePermission=n.handleTogglePermission.bind(Object(c.a)(n)),n.isPostChangeValid=n.isPostChangeValid.bind(Object(c.a)(n)),n.getPermissionLabel=n.getPermissionLabel.bind(Object(c.a)(n)),n.onUploadAlbumChange=n.onUploadAlbumChange.bind(Object(c.a)(n)),n.handleDeletePhoto=n.handleDeletePhoto.bind(Object(c.a)(n)),n}return Object(d.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.t,a=e.progress,i=e.albumDialogOpen,r=this.state,s=r.menuOpen,l=r.videoLinkOpen,c=r.image,d=r.postType,j=r.galleryOpen,T=r.selectedPhotos,N=r.thumbnail,R=r.permissionOpen,W=r.permission,A=r.menuAnchorEl,z=void 0!==i&&i,V=J.a.createElement("div",null,J.a.createElement(P.a,{id:"tooltip-icon",title:n("post.moreTooltip"),placement:"bottom-start"},J.a.createElement(C.a,{onClick:this.handleOpenMenu},J.a.createElement(L.a,null))),J.a.createElement(w.a,{open:s,anchorEl:A,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},onClose:this.handleCloseMenu},J.a.createElement(x.a,{onClick:this.handleToggleComments,style:{fontSize:"14px"}},this.state.disableComments?n("post.enableComments"):n("post.disableComments")," "),J.a.createElement(x.a,{onClick:this.handleToggleSharing,style:{fontSize:"14px"}},(this.state.disableSharing,n("post.disableSharing"))))),q=J.a.createElement(xe.a,{fullName:this.props.ownerDisplayName,fileName:this.props.ownerAvatar,size:36}),G=J.a.createElement("div",{className:t.author},J.a.createElement("span",{style:{fontSize:"14px",paddingRight:"10px",fontWeight:400,color:"rgba(0,0,0,0.87)",textOverflow:"ellipsis",overflow:"hidden",lineHeight:"25px"}},"".concat(this.props.ownerDisplayName," |")),J.a.createElement("span",{onClick:this.handleTogglePermission,className:_()(t.permission,t.disableComponent)},"".concat(this.getPermissionLabel()))),Y=c&&""!==c&&d===Ue.a.Photo||N&&""!==N&&d===Ue.a.Video?J.a.createElement("div",null,J.a.createElement("div",{style:{position:"relative",overflowY:"hidden",overflowX:"auto"}},J.a.createElement("ul",{style:{position:"relative",whiteSpace:"nowrap",padding:"0 0 0 16px",margin:"8px 0 0 0",paddingRight:"16px",verticalAlign:"bottom",flexShrink:0,listStyleType:"none"}},J.a.createElement("div",{style:{display:"flex",position:"relative"}},J.a.createElement("span",{onClick:this.handleRemoveImage,style:{position:"absolute",width:"28px",backgroundColor:"rgba(6, 6, 6, 0.82)",height:"28px",right:12,top:4,cursor:"pointer",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center"}},J.a.createElement(U.a,{style:{color:"rgba(239, 235, 235, 0.83)"}})),J.a.createElement("span",{className:_()(t.playVideo,Object(o.a)({},t.noDisplay,d!==Ue.a.Video)),style:{}},J.a.createElement(M.a,{className:t.playIcon})),J.a.createElement("div",{style:{display:"inline-block",width:"100%",marginRight:"8px",transition:"transform .25s"}},J.a.createElement("li",{style:{width:"100%",margin:0,verticalAlign:"bottom",position:"static"}},J.a.createElement(ae.a,{fileName:d===Ue.a.Photo?c:N,style:{width:"100%",height:"auto"}}))))))):"";return J.a.createElement("div",{style:this.props.style},this.props.children,J.a.createElement(f.a,{BackdropProps:{className:t.backdrop},PaperProps:{className:t.fullPageXs},key:this.props.id||0,open:this.props.open,onClose:this.props.onRequestClose},J.a.createElement(y.a,{className:t.dialogTitle},J.a.createElement(h.a,{title:G,avatar:q,action:V})),J.a.createElement(v.a,{className:t.content,style:{paddingTop:0}},J.a.createElement(u.a,{elevation:0},J.a.createElement(m.a,null,J.a.createElement(E.a,{item:!0,xs:12},J.a.createElement("div",{style:{display:"flex",flexDirection:"column",flexGrow:1}},J.a.createElement("div",{style:{position:"relative",flexDirection:"column",display:"flex",flexGrow:1,overflowY:"auto",maxHeight:"300px"}},J.a.createElement(S.a,{autoFocus:!0,value:this.state.postText,onChange:this.handleOnChange,placeholder:n("post.textareaPlaceholder"),multiline:!0,rows:2,rowsMax:4,style:{fontWeight:400,fontSize:"14px",margin:"0 16px",flexShrink:0,width:"initial",flexGrow:1}}),Y,j&&J.a.createElement(we,{photos:T,progress:a,onDelete:this.handleDeletePhoto}))))))),J.a.createElement(b.a,{className:t.iconButtonsRoot},J.a.createElement("div",{style:{flexShrink:0,boxFlex:0,flexGrow:0,maxHeight:"48px",width:"100%"}},J.a.createElement("div",{style:{flexDirection:"row",display:"flex"}},J.a.createElement("input",{accept:"image/*",className:t.input,id:"album-button-file",multiple:!0,onChange:this.onUploadAlbumChange,type:"file"}),J.a.createElement("div",{style:{outline:"none",width:"48px",zIndex:0,overflow:"hidden",position:"relative",textAlign:"center",transition:"background .3s",border:0,borderRadius:"50%",display:"inlineBlock",height:"48px"}},J.a.createElement("span",{style:{top:"15px",display:"block",position:"relative",cursor:"pointer"}},J.a.createElement("label",{htmlFor:"album-button-file"},J.a.createElement(D.a,{style:{color:"grey"}})))),J.a.createElement("div",{onClick:this.handleOpenVideoLink,style:{outline:"none",width:"48px",zIndex:0,overflow:"hidden",position:"relative",textAlign:"center",transition:"background .3s",border:0,borderRadius:"50%",display:"inlineBlock",height:"48px"}},J.a.createElement("span",{style:{top:"12px",display:"block",position:"relative",cursor:"pointer"}},J.a.createElement(B.a,{style:{color:"grey",width:30,height:30}}))),J.a.createElement("div",{className:t.disableComponent,onClick:this.handleOpenVideoGallery,style:{outline:"none",width:"48px",zIndex:0,overflow:"hidden",position:"relative",textAlign:"center",transition:"background .3s",border:0,borderRadius:"50%",display:"inlineBlock",height:"48px"}},J.a.createElement("span",{style:{top:"14px",display:"block",position:"relative",cursor:"pointer"}},J.a.createElement(F.a,{style:{color:"grey",width:24,height:24}})))))),J.a.createElement(b.a,null,J.a.createElement(p.a,{color:"primary",disableFocusRipple:!0,disableRipple:!0,onClick:this.props.onRequestClose,style:{color:g.a[800]}},n("post.cancelButton")),J.a.createElement(p.a,{color:"primary",disableFocusRipple:!0,disableRipple:!0,onClick:this.handlePost,disabled:this.state.disabledPost},this.props.edit?n("post.updateButton"):n("post.postButton")))),z?J.a.createElement(ne.a,{open:z,progress:a,photos:this.selectedPhotos,onClose:this.closeAlbumDialog}):"",J.a.createElement(f.a,{PaperProps:{className:_()(t.fullPageXs,t.videoGallery)},open:this.state.videoGalleryOpen,onClose:this.handleCloseVideoGallery},J.a.createElement(b.a,{className:t.galleryActions},J.a.createElement(k.a,{variant:"h6",component:"div",className:t.galleryDialogTitle},J.a.createElement(F.a,{style:{color:"rgb(230, 35, 35)",margin:"0 10px",width:24,height:24}}),n("post.videoGalleryLabel")),J.a.createElement(C.a,{onClick:this.handleCloseVideoGallery},J.a.createElement(I.a,null))),J.a.createElement(O.a,{className:t.devider}),J.a.createElement(v.a,null,J.a.createElement(We,{set:this.onSetVideo,close:this.handleCloseVideoGallery}))),J.a.createElement(te,{open:l,onClose:this.handleCloseVideoLink,onAddLink:this.onSetVideo}),J.a.createElement(je.a,{onClose:this.handleTogglePermission,open:R,onAddAccessList:this.handleAccessList,access:W}))}}]),t}(X.Component),Je=Object(Z.c)("translations")(Xe),Qe=(_e=Object(j.a)((function(e){return Object(Ge.a)({fullPageXs:Object(o.a)({minWidth:500,maxWidth:500,maxHeight:540},e.breakpoints.down("xs"),{minWidth:"100%",maxWidth:"100%",maxHeight:"100%",width:"100%",height:"100%",margin:0,overflowY:"auto"}),backdrop:{top:0,left:0,width:"100%",height:"100%",position:"fixed",willChange:"opacity",backgroundColor:"rgba(251, 249, 249, 0.5)",WebkitTapHighlightColor:"transparent"},input:{},content:{padding:0,paddingTop:0},dialogRoot:{paddingTop:0},popperOpen:{zIndex:10},popperClose:{pointerEvents:"none",zIndex:0},author:{paddingRight:70},dialogTitle:{padding:0},iconButtonsRoot:{justifyContent:"flex-start",margin:"0px 4px"},playVideo:{position:"absolute",right:"45%",top:"45%",cursor:"pointer",backgroundColor:"#f1efeca3",borderRadius:"50%",height:60,padding:0},playIcon:{width:60,height:60,fill:"red"},noDisplay:{display:"none"},playIconButtonRoot:{width:60,height:60},galleryActions:{margin:0,background:"#fff",WebkitBoxSizing:"border-box",boxSizing:"border-box",height:56,textAlign:"center",padding:4,minWidth:0,display:"flex",flexDirection:"row",justifyContent:"space-between"},galleryDialogTitle:{color:"#676767"},galleryDialogIcon:{},galleryAction:{margin:0,padding:0,minWidth:0},devider:{marginBottom:10},videoGallery:{},permission:{fontWeight:400,fontSize:"14px",cursor:"pointer",color:"blue"},disableComponent:{opacity:"0.2","pointer-events":"none"}})}))(Je),Object(Q.connect)(qe,Fe)(_e));t.a=Qe},592:function(e,t,n){"use strict";var a=n(15),o=n(8),i=n(43),r=n(49),s=n(45),l=n(86),c=n(48),d=n(1128),p=n(824),u=n(1135),m=n(1129),h=n(1144),g=n(760),f=n(524),b=n(532),v=n(279),y=n(1112),O=n(16),E=n(684),C=n.n(E),w=n(629),x=n.n(w),j=n(683),S=n.n(j),P=n(546),k=n.n(P),T=n(585),I=n.n(T),N=n(630),L=n.n(N),R=n(154),D=n.n(R),W=n(0),M=n.n(W),A=n(4),U=n(1150),z=n(800),B=n(1130),V=n(696),F=n(308),q=n(522),G=n(474),Y=n(53),H=n(473),_=n(471),X=n(470),J=n(202),Q=n(58),$=n.n(Q),Z=n(36),K=n(180),ee=n(61),te=n(106),ne=n(583),ae=n.n(ne),oe=n(155),ie=n(38),re=n(52),se=function(e){return{textField:{fontWeight:400,fontSize:"14px ",width:"100%",margin:0,WebkitBoxShadow:"none",boxShadow:"none",borderColor:"transparent",height:38,border:"1px solid #000",resize:"none"},header:{padding:"2px 3px 3px 10px"},popperOpen:{zIndex:11},popperClose:{pointerEvents:"none",zIndex:0},iconButton:{top:0,display:"flex",right:4,flexDirection:"row-reverse",position:"absolute"},commentBody:{color:"black",fontWeight:400,fontSize:"12px",height:"100%",border:"none",width:"100%",outline:"none",resize:"none"},rightIconMenuItem:{fontSize:12,fontWeight:300,paddingLeft:6,paddingRight:6,paddingTop:0,paddingBottom:0},moreIcon:{width:"0.6em",height:"0.6em"},menuRoot:{marginTop:7,marginRight:7}}},le=n(39),ce=function(e,t){return{delete:function(t,n){return e(oe.dbDeleteComment(t,n))},update:function(t){e(oe.dbUpdateComment(t))},openEditor:function(){return e(oe.openCommentEditor({id:t.comment.get("id","0"),postId:t.comment.get("postId")}))},closeEditor:function(){return e(oe.closeCommentEditor(t.comment.get("postId"),t.comment.get("id","0")))},getUserInfo:function(){return e(ie.dbGetUserInfoByUserId(t.comment.get("ownerUserId","0"),""))}}},de=function(){var e=le.a.selectCurrentUser(),t=re.a.selectUserProfileById();return function(n,a){var o=a.comment.get("ownerUserId","0"),i=e(n),r=i.get("userId","0");return{uid:r,avatar:a.comment.get("ownerAvatar","0"),fullName:i.get("ownerDisplayName","loading..."),isCommentOwner:r===o,commentOwner:t(n,{userId:o})}}},pe=function(e){var t=Object(te.c)("translations")(e);return Object(ee.connect)(de,ce)(ae()(se)(t))}(function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(r.a)(this,Object(s.a)(t).call(this,e))).buttonMenu=null,n.styles={author:{fontSize:"10px",paddingRight:"10px",fontWeight:400,color:"rgba(0,0,0,0.87)",textOverflow:"ellipsis",overflow:"hidden"},textarea:{fontWeight:400,fontSize:"14px",border:"none",width:"100%",outline:"none",resize:"none"},cancel:{float:"right",clear:"both",zIndex:5,margin:"0px 5px 5px 0px",fontWeight:400}},n.textareaRef=void 0,n.divCommentRef=void 0,n.inputText=void 0,n.divComment=void 0,n.handleEditComment=function(e){n.setState({openMenu:!1}),n.props.openEditor()},n.handleCancelEdit=function(e){n.setState({text:n.state.initialText}),n.props.closeEditor()},n.handleUpdateComment=function(e){var t=n.props.comment.set("text",n.state.text);n.props.update(t),n.setState({initialText:n.state.text})},n.handleOnChange=function(e){var t=e.target.value;0===t.length||""===t.trim()||t.trim()===n.state.initialText?n.setState({text:t,editDisabled:!0}):n.setState({text:t,editDisabled:!1})},n.handleDelete=function(e,t,a){n.props.delete(t,a)},n.handleCommentMenu=function(e){n.setState({openMenu:!0,anchorEl:Object(Z.findDOMNode)(n.buttonMenu)})},n.handleCloseCommentMenu=function(){n.setState({openMenu:!1})},n.textareaRef=function(e){n.inputText=e},n.divCommentRef=function(e){n.divComment=e},n.state={text:n.props.comment.get("text",""),initialText:n.props.comment.get("text",""),editDisabled:!0,isPostOwner:!1,openMenu:!1,anchorEl:null},n.handleDelete=n.handleDelete.bind(Object(l.a)(n)),n.handleUpdateComment=n.handleUpdateComment.bind(Object(l.a)(n)),n.handleOnChange=n.handleOnChange.bind(Object(l.a)(n)),n.handleCancelEdit=n.handleCancelEdit.bind(Object(l.a)(n)),n.handleEditComment=n.handleEditComment.bind(Object(l.a)(n)),n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.commentOwner;this.props.isCommentOwner||e||this.props.getUserInfo()}},{key:"render",value:function(){var e=this,t=this.props,n=t.comment,a=t.classes,o=(t.fullName,t.avatar,t.t),i=t.editorStatus,r=this.state,s=r.openMenu,l=r.anchorEl,c=M.a.createElement("div",{className:a.menuRoot},this.props.isCommentOwner&&M.a.createElement(f.a,{buttonRef:function(t){e.buttonMenu=t},"aria-owns":s?"comment-menu":"","aria-haspopup":"false",onClick:this.handleCommentMenu},M.a.createElement(k.a,{className:a.moreIcon})),M.a.createElement(_.a,{open:s,anchorEl:l,anchorReference:"anchorEl",anchorPosition:{top:0,left:0},onClose:this.handleCloseCommentMenu,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"bottom",horizontal:"center"}},M.a.createElement(H.a,{role:"menu"},this.props.isCommentOwner?M.a.createElement(y.a,{className:a.rightIconMenuItem,onClick:this.handleEditComment},o("comment.editButton")):"",this.props.isCommentOwner||this.props.isPostOwner?M.a.createElement(y.a,{className:a.rightIconMenuItem,onClick:function(t){return e.handleDelete(t,n.get("id","0"),n.get("postId","0"))}},o("comment.deleteButton")):""))),p=n.get("ownerUserId"),u=M.a.createElement("div",{style:{outline:"none",flex:"auto",flexGrow:1}},i?M.a.createElement(X.a,{placeholder:o("comment.updateCommentPlaceholder"),autoFocus:!0,rowsMax:"4",value:this.state.text,onChange:this.handleOnChange,className:a.textField}):M.a.createElement("div",{className:D()("animate2-top10",a.commentBody)},this.state.text),M.a.createElement("div",{style:{display:i?"flex":"none",flexDirection:"row-reverse"}},M.a.createElement(z.a,{color:"primary",disabled:this.state.editDisabled,style:{float:"right",clear:"both",zIndex:5,margin:"0px 5px 5px 0px",fontWeight:400},onClick:this.handleUpdateComment}," ",o("comment.updateButton")," "),M.a.createElement(z.a,{color:"primary",style:this.styles.cancel,onClick:this.handleCancelEdit}," ",o("comment.cancelButton")," ")));return M.a.createElement("div",{className:"animate-top",key:n.get("id","0")},M.a.createElement(F.a,{elevation:0,className:"animate2-top10",style:{position:"relative",padding:"",display:this.state.display?"none":"block"}},M.a.createElement(d.a,{elevation:0},M.a.createElement(m.a,{className:a.header,title:i?"":M.a.createElement((function(){return M.a.createElement("div",null,M.a.createElement(K.a,{to:"/".concat(p)}," ",M.a.createElement("span",{style:e.styles.author},n.get("ownerDisplayName","Loading..."))),M.a.createElement("span",{style:{fontWeight:400,fontSize:"8px"}},$()(n.get("creationDate",0)).local().fromNow()))}),null),subheader:u,avatar:M.a.createElement(K.a,{to:"/".concat(p)},M.a.createElement(J.a,{fullName:n.get("ownerDisplayName",""),fileName:n.get("ownerAvatar",""),size:24})),action:!this.props.isCommentOwner&&!this.props.isPostOwner&&this.props.disableComments||i?"":c}))))}}]),t}(W.Component)),ue=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(r.a)(this,Object(s.a)(t).call(this,e))).commentList=function(){var e=Object(A.Map)(n.props.comments),t=Object(A.Map)(n.props.commentsEditorStatus);if(!e.isEmpty()){var a=Y.c(e.valueSeq()),o=[];return a.forEach((function(e){o.push(M.a.createElement(pe,{key:e.get("id"),comment:e,isPostOwner:n.props.isPostOwner,disableComments:n.props.disableComments,editorStatus:t.get(e.get("id","0"),!1)}))})),o}},n.state={},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.postId;return M.a.createElement(G.a,{key:"comment-list-".concat(n),className:t.list},this.commentList())}}]),t}(W.Component),me=Object(ee.connect)((function(e,t){return{commentsEditorStatus:e.getIn(["comment","editorStatus",t.postId],{})}}),(function(e,t){return{}}))(Object(O.a)((function(e){return{list:{width:"100%",maxHeight:290,overflowY:"auto",overflowX:"visible"}}}))(ue)),he=n(19),ge=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,i=new Array(a),l=0;l<a;l++)i[l]=arguments[l];return(n=Object(r.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(i)))).id=void 0,n.postId=void 0,n.text=void 0,n.score=void 0,n.creationDate=void 0,n.ownerDisplayName=void 0,n.ownerAvatar=void 0,n.ownerUserId=void 0,n}return Object(c.a)(t,e),t}(n(14).a),fe=n(539),be=n(17),ve=n(50),ye=n(33),Oe=function(e){return{textField:{fontWeight:400,fontSize:"14px"},header:{padding:"2px 3px 3px 10px"},commentBody:{color:"black",fontWeight:400,fontSize:"12px",height:"100%",border:"none",width:"100%",outline:"none",resize:"none",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},author:{fontSize:"10px",paddingRight:"10px",fontWeight:400,color:"rgba(0,0,0,0.87)",textOverflow:"ellipsis",overflow:"hidden"},noUnderline:{display:"none"},postButton:{flexDirection:"row-reverse"},cardHeaderContent:{flex:"1 1 auto",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}}},Ee=function(e,t){return{send:function(t){e(be.c.dbAddComment(t))}}},Ce=function(){var e=le.a.selectCurrentUser(),t=fe.a.selectRequest();return function(n,a){var o=a.postId,i=ve.a.createServerRequestId(ye.a.CommentGetComments,o),r=e(n),s=t(n,{requestId:i});return{commentsRequestStatus:s?s.status:he.a.NoAction,uid:r.get("userId",""),avatar:r.get("avatar",""),fullName:r.get("fullName","")}}},we=function(e){var t=Object(te.c)("translations")(e);return Object(ee.connect)(Ce,Ee)(ae()(Oe)(t))}(function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(r.a)(this,Object(s.a)(t).call(this,e))).styles={commentItem:{height:"60px",position:"",zIndex:""},toggleShowList:{height:"60px",zIndex:5},writeCommentTextField:{width:"100%",fontWeight:400,fontSize:"14px"},progressbar:{height:"1.5px",backgroundColor:"rgb(245, 243, 243)",color:B.a.A400},secondaryText:{fontSize:"13px",lineHeight:"20px",color:"rgba(0,0,0,0.87)",fontWeight:300,whiteSpace:"pre-wrap"},primaryText:{fontSize:"13px",paddingRight:"10px",fontWeight:400,color:"rgba(0,0,0,0.87)",textOverflow:"ellipsis",overflow:"hidden"}},n.clearCommentWrite=function(){n.setState({commentText:"",postDisable:!0})},n.handlePostComment=function(){var e=n.props,t=e.postId,a=e.fullName,o=e.avatar,i=e.uid,r=new ge;r.postId=t,r.text=n.state.commentText,r.ownerAvatar=o,r.ownerDisplayName=a,r.ownerUserId=i,n.props.send(Object(A.Map)(r)),n.clearCommentWrite()},n.handleChange=function(e){var t=e.target.value;n.setState({commentText:t}),0===t.length||""===t.trim()?n.setState({commentText:"",postDisable:!0}):n.setState({commentText:t,postDisable:!1})},n.commentWriteBox=function(){var e=n.props,t=e.classes,a=e.postId,o=e.fullName,i=e.avatar,r=e.t;return M.a.createElement("div",null,M.a.createElement(V.a,null),M.a.createElement(F.a,{key:a+"-commentwrite",elevation:0,className:"animate2-top10"},M.a.createElement(d.a,{elevation:0},M.a.createElement(m.a,{className:t.header,avatar:M.a.createElement(J.a,{fullName:o,fileName:i,size:24}),subheader:M.a.createElement(q.a,{autoFocus:!0,placeholder:r("comment.addCommentPlaceholder"),multiline:!0,rowsMax:"4",InputProps:{disableUnderline:!0,autoFocus:!0,fullWidth:!0},value:n.state.commentText,onChange:n.handleChange,className:t.textField,fullWidth:!0})}),M.a.createElement(p.a,{className:t.postButton},M.a.createElement(z.a,{color:"primary",disabled:n.state.postDisable,onClick:n.handlePostComment},r("comment.postButton"))))))},n.loadCommentsList=function(){var e=n.props,t=e.postId,a=e.open,o=n.props.comments||Object(A.Map)({});return o&&o.size>0?M.a.createElement(F.a,{elevation:0,style:a?{display:"block",padding:"0px 0px"}:{display:"none",padding:"12px 16px"}},M.a.createElement(me,{comments:o,isPostOwner:n.props.isPostOwner,disableComments:n.props.disableComments,postId:t})):""},n.state={commentText:"",postDisable:!0},n.handlePostComment=n.handlePostComment.bind(Object(l.a)(n)),n.clearCommentWrite=n.clearCommentWrite.bind(Object(l.a)(n)),n.commentWriteBox=n.commentWriteBox.bind(Object(l.a)(n)),n.loadCommentsList=n.loadCommentsList.bind(Object(l.a)(n)),n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){var n=!1;return U.a(this.state,t)?e.open!==this.props.open?n=!0:e.disableComments!==this.props.disableComments?n=!0:e.commentsRequestStatus!==this.props.commentsRequestStatus?n=!0:e.comments!==this.props.comments&&(n=!0):n=!0,n}},{key:"render",value:function(){var e=this.props,t=e.postId,n=e.open,a=e.comments,o=e.commentsRequestStatus,i=M.a.createElement(b.a,{style:this.styles.progressbar,variant:"indeterminate"});return M.a.createElement("div",{key:t+"-comments-group"},a&&a.size>0&&M.a.createElement(V.a,null),M.a.createElement("div",{style:n?{display:"block"}:{display:"none"}},M.a.createElement(F.a,{elevation:0,className:"animate-top",style:n?{display:"none"}:{display:"block"}},M.a.createElement("div",{style:{position:"relative",height:"60px"}},M.a.createElement(z.a,{style:this.styles.toggleShowList,fullWidth:!0,onClick:this.props.onToggleRequest}," "," ")))),n?o===he.a.Sent?i:this.loadCommentsList():"",!this.props.disableComments&&n?this.commentWriteBox():"")}}]),t}(W.Component)),xe=n(544),je=n(569),Se=n(931),Pe=n(292),ke=n.n(Pe),Te=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(r.a)(this,Object(s.a)(t).call(this,e))).state={expanded:!1,truncated:!1},n.toggleLines=n.toggleLines.bind(Object(l.a)(n)),n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"toggleLines",value:function(e){e.preventDefault(),this.setState({expanded:!this.state.expanded})}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.lines,o=e.classes,i=e.body,r=this.state.expanded,s=M.a.createElement("div",{onClick:this.toggleLines,className:D()(o.root,Object(a.a)({},o.expanded,!r))},M.a.createElement(Se.a,{in:r,collapsedHeight:"173px"},t));return(ve.a.isEmpty(i)?0:ve.a.getNumberOfLines(i))>n?s:t}}]),t}(W.Component);Te.defaultProps={lines:3,more:"Read more",less:"Show less"};var Ie,Ne=ke()((function(e){return{root:{position:"relative"},expanded:{"&:before":{content:"",float:"left",width:5,height:"100%"},"&:after":{content:'"\\002026"',fontSize:34,fontWeight:500,color:"#4285f4",boxSizing:"content-box",float:"right",position:"absolute",top:150,left:"100%",height:20,width:"2em",marginLeft:"-2em",paddingRight:5,textAlign:"right",background:"linear-gradient(to right,rgba(255,255,255,0),white 50%,white)",cursor:"pointer"}}}}))(Te),Le=n(1114),Re=n(1113),De=n(530),We=n(178),Me=n(671),Ae=n.n(Me),Ue=n(1136),ze=n(1137),Be=n(1138),Ve=n(1139),Fe=n(1140),qe=n(1141),Ge=n(1142),Ye=n(1143),He=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(r.a)(this,Object(s.a)(t).call(this,e))).state={},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.t,a=e.shareOpen,o=e.onClose,i=e.openCopyLink,r=e.post,s=e.onCopyLink;return M.a.createElement(Le.a,{className:t.fullPageXs,title:"Share On",open:a,onClose:o},M.a.createElement(F.a,{className:t.shareLinkPaper},i?M.a.createElement("div",null,M.a.createElement(q.a,{autoFocus:!0,fullWidth:!0,id:"text-field-default",defaultValue:"".concat(window.location.origin,"/").concat(r.get("ownerUserId"),"/posts/").concat(r.get("id"))}),M.a.createElement(We.a,{className:D()("animate-top",t.clipboard),variant:"h5",component:"h2"},"Link has been copied to clipboard ...")):M.a.createElement(H.a,null,M.a.createElement("div",null,M.a.createElement(Ue.a,{onShareWindowClose:o,url:"".concat(window.location.origin,"/").concat(r.get("ownerUserId"),"/posts/").concat(r.get("id")),quote:r.get("body"),hashtag:r.get("tags",Object(A.List)([])).count()>0?"#".concat(r.getIn(["tags",0],"hashtag")):null},M.a.createElement(y.a,null,M.a.createElement(Re.a,{classes:{root:t.networkShare}},M.a.createElement(ze.a,{size:32,round:!0})),M.a.createElement(De.a,{inset:!0,primary:n("post.facebookButton")})))),M.a.createElement("div",null,M.a.createElement(Be.a,{onShareWindowClose:o,url:"".concat(window.location.origin,"/").concat(r.get("ownerUserId"),"/posts/").concat(r.get("id")),quote:r.get("body"),hashtag:"#".concat(r.getIn(["tags",0],""))},M.a.createElement(y.a,null,M.a.createElement(Re.a,{classes:{root:t.networkShare}},M.a.createElement(Ve.a,{size:32,round:!0})),M.a.createElement(De.a,{inset:!0,primary:n("post.twitterButton")})))),M.a.createElement("div",null,M.a.createElement(Fe.a,{onShareWindowClose:o,url:"".concat(window.location.origin,"/").concat(r.get("ownerUserId"),"/posts/").concat(r.get("id")),quote:r.get("body"),hashtag:"#".concat(r.getIn(["tags",0],""))},M.a.createElement(y.a,null,M.a.createElement(Re.a,{classes:{root:t.networkShare}},M.a.createElement(qe.a,{size:32,round:!0})),M.a.createElement(De.a,{inset:!0,primary:n("post.linkedinButton")})))),M.a.createElement("div",null,M.a.createElement(Ge.a,{onShareWindowClose:o,url:"".concat(window.location.origin,"/").concat(r.get("ownerUserId"),"/posts/").concat(r.get("id")),quote:r.get("body"),hashtag:"#".concat(r.getIn(["tags",0],""))},M.a.createElement(y.a,null,M.a.createElement(Re.a,{classes:{root:t.networkShare}},M.a.createElement(Ye.a,{size:32,round:!0})),M.a.createElement(De.a,{inset:!0,primary:n("post.googlePlusButton")})))),M.a.createElement(y.a,{onClick:s},M.a.createElement(Re.a,null,M.a.createElement(Ae.a,null)),M.a.createElement(De.a,{inset:!0,primary:n("post.copyLinkButton")})))))}}]),t}(W.Component),_e=Object(te.c)("translations")(He),Xe=Object(ee.connect)((function(e,t){return{}}),(function(e,t){return{}}))(Object(O.a)((function(e){return{image:{verticalAlign:"top",maxWidth:"100%",minWidth:"100%",width:"100%"},clipboard:{fontSize:"18px",textAlign:"center",marginTop:"10px",color:"#1e882d",fontWeight:400},networkShare:{width:"100%",height:"100%"},fullPageXs:Object(a.a)({},e.breakpoints.down("xs"),{width:"100%",height:"100%",margin:0,overflowY:"auto"}),shareLinkPaper:{minHeight:80,padding:10,minWidth:460}}}))(_e)),Je=n(672),Qe=n.n(Je),$e=n(80),Ze=n(204),Ke=n(673),et=n.n(Ke),tt=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(r.a)(this,Object(s.a)(t).call(this,e))).handleClick=function(e,t){var a=n.props.onClick;a&&a(e,t)},n.state={},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"getData",value:function(){var e=this,t=this.props,n=t.classes,o=t.images,i=Math.floor(2*Math.random()+1);return o.length>1?M.a.createElement("div",{className:n.container},M.a.createElement("div",{className:D()(Object(a.a)({},n.firstColumn,1===i),Object(a.a)({},n.firstRow,2===i))},M.a.createElement(h.a,{image:o[0].url,onClick:function(t){return e.handleClick(t,0)},className:D()(n.mediaCard,n.featureCard)})),M.a.createElement("div",{className:D()(Object(a.a)({},n.column,1===i),Object(a.a)({},n.row,2===i))},o.map((function(t,a){return 0!==a?M.a.createElement(h.a,{key:a,onClick:function(t){return e.handleClick(t,a)},image:t.url,className:n.mediaCard}):""})))):M.a.createElement(xe.a,{fileName:o[0].url,onClick:function(t){return e.handleClick(t,0)}})}},{key:"render",value:function(){var e=this.props.classes;return M.a.createElement("div",{className:e.mainContainer},this.getData())}}]),t}(W.Component),nt=Object(O.a)((function(e){return{mainContainer:{width:"100%"},container:{display:"flex",flexWrap:"wrap",marginTop:20,width:"100%",height:415,position:"relative"},firstRow:{flex:"100%",display:"flex",paddingBottom:1},row:{flex:"100%",display:"flex",marginTop:1,marginBottom:1},firstColumn:{flex:"50%",display:"flex",flexDirection:"column",paddingRight:1},column:{flex:"50%",display:"flex",flexDirection:"column",paddingLeft:1,paddingRight:2},mediaCard:{height:"100%",width:"100%",backgroundSize:"cover",margin:1}}}))(tt),at=n(604),ot=n.n(at),it=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(r.a)(this,Object(s.a)(t).call(this,e))).handleImageClick=function(e,t){t(e)},n.state={},n.handleImageClick=n.handleImageClick.bind(Object(l.a)(n)),n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){return!U.a(e.images,this.props.images)}},{key:"render",value:function(){var e=this,t=this.props,n=t.classes,o=t.images,i=t.currentAlbum;if(o&&o.size>0){var r=[];o.valueSeq().forEach((function(e){r.push({src:e,url:e,id:e})}));var s=r.slice(0,4);return M.a.createElement(ot.a,{images:r,renderImageFunc:function(t){return M.a.createElement("div",{className:n.root},M.a.createElement(nt,{images:s,onClick:function(n,a){return e.handleImageClick(a,t)}}),M.a.createElement("div",{className:D()(n.titleContainer,Object(a.a)({},n.noDisplay,!(i&&i.get("album").get("title"))))},M.a.createElement("div",{className:n.aboveContainer}),M.a.createElement("div",{className:n.bottomContainer}),M.a.createElement(K.a,{to:"/u/".concat(i&&i.get("ownerUserId"),"/album/").concat(i&&i.get("id"))},M.a.createElement(We.a,{className:n.title},i&&i.get("album").get("title")))))}})}return M.a.createElement("div",{className:n.noAlbum},M.a.createElement(et.a,{className:n.noAlbumIcon}))}}]),t}(W.Component),rt=ke()((function(e){return{root:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",overflow:"hidden",position:"relative",backgroundColor:e.palette.background.paper},gridList:{width:500,height:450},subheader:{width:"100%"},descRoot:{bottom:0,left:0,position:"absolute",right:0,zIndex:1},topGradiant:{background:"linear-gradient(to bottom, rgba(0,0,0,0), rgba(0,0,0,.6))",height:32},shadow:{backgroundColor:"rgba(0,0,0,.6)",padding:24,textAlign:"center",verticalAlign:"middle"},albumTitle:{color:"white"},noDisplay:{display:"none"},noAlbum:{display:"flex",justifyContent:"center",alignItems:"center"},noAlbumIcon:{fontSize:50},aboveContainer:{background:"linear-gradient(to bottom, rgba(0,0,0,0), rgba(0,0,0,.6))",height:30},bottomContainer:{backgroundColor:"rgba(0,0,0,.6)",height:70},titleContainer:{position:"absolute",bottom:0,left:1,right:1,height:100},title:{textAlign:"center",fontSize:22,fontWeight:400,color:"white",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}}}))(it),st=n(674),lt=n.n(st),ct=n(675),dt=n.n(ct),pt=n(681),ut=n.n(pt),mt=n(22),ht=n(179),gt=n(5),ft=n(47),bt=n(156),vt=n(27),yt=function(e,t){return e.getIn(["comment","postComments",t.postId],Object(A.Map)({}))},Ot=function(){return Object(vt.a)([yt],(function(e){return e}))},Et=n(30),Ct=function(e,t){var n=t.post;return{vote:function(){return e(bt.dbAddVote(n.get("id"),n.get("ownerUserId")))},unvote:function(){return e(bt.dbDeleteVote(n.get("id"),n.get("ownerUserId")))},delete:function(t){return e(ft.dbDeletePost(t))},toggleDisableComments:function(t){e(ft.dbUpdatePost(n.set("disableComments",t),(function(e){return e})))},toggleSharingComments:function(t){e(ft.dbUpdatePost(n.set("disableSharing",t),(function(e){return e})))},goTo:function(t){return e(Object(ht.a)(t))},setHomeTitle:function(t){return e(gt.setHeaderTitle(t||""))},getPostComments:function(t,n,a,o){return e(oe.dbFetchComments(t,n,a,o))}}},wt=function(){var e=Et.b.selectCurrentUser(),t=Ot();return function(n,a){var o=t(n,{postId:a.post.get("id")}),i=e(n).get("userId"),r=a.post.get("score",0),s=a.post.getIn(["votes",i],!1);return{commentList:o,avatar:a.post.get("ownerAvatar",""),fullName:a.post.get("ownerDisplayName",""),voteCount:r,currentUserVote:s,isPostOwner:i===a.post.get("ownerUserId")}}},xt=function(e){function t(e){var n;Object(o.a)(this,t),(n=Object(r.a)(this,Object(s.a)(t).call(this,e))).styles={dialog:{width:"",maxWidth:"530px",borderRadius:"4px"}},n.handleOpenComments=function(){var e=n.props,t=e.getPostComments,a=e.post;t(a.get("ownerUserId"),a.get("id"),0,10),n.setState({openComments:!n.state.openComments})},n.handleOpenPostWrite=function(){n.closePostMenu(),n.setState({openPostWrite:!0})},n.handleClosePostWrite=function(){n.setState({openPostWrite:!1})},n.handleDelete=function(){var e=n.props.post;n.closePostMenu(),n.props.delete(e.get("id"))},n.openPostMenu=function(e){n.setState({postMenuAnchorEl:e.currentTarget,isPostMenuOpen:!0})},n.closePostMenu=function(){n.setState({postMenuAnchorEl:null,isPostMenuOpen:!1})},n.handleCopyLink=function(){var e=n.props.t;n.setState({openCopyLink:!0,shareTitle:e("post.copyLinkButton")})},n.handleOpenShare=function(){var e=n.props.post;Qe()("".concat(window.location.origin,"/").concat(e.get("ownerUserId"),"/posts/").concat(e.get("id"))),n.setState({shareOpen:!0})},n.handleCloseShare=function(){n.setState({shareOpen:!1,shareTitle:"Share On",openCopyLink:!1})},n.handleVote=function(){n.props.currentUserVote?n.props.unvote():n.props.vote()},n.getOpenCommentGroup=function(e){n.setState({openCommentGroup:e})},n.onShowVideo=function(){n.setState({showVideo:!0})},n.getPermissionLabel=function(){var e=n.props,t=e.t,a=e.post.get("permission"),o="";return a===$e.a.Public?o=t("permission.public"):a===$e.a.Circles?o=t("permission.circles"):a===$e.a.OnlyMe&&(o=t("permission.onlyMe")),o},n.rightIconMenu=function(){var e=n.props,t=e.post,a=e.t,o=n.state,i=o.postMenuAnchorEl,r=o.isPostMenuOpen;return M.a.createElement("div",null,M.a.createElement(f.a,{onClick:n.openPostMenu.bind(Object(l.a)(n))},M.a.createElement(k.a,null)),M.a.createElement(v.a,{open:r,anchorEl:i,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},onClose:n.closePostMenu},t.get("postTypeId")!==Ze.a.Album&&M.a.createElement(y.a,{onClick:n.handleOpenPostWrite}," ",a("post.edit")," "),M.a.createElement(y.a,{onClick:n.handleDelete}," ",a("post.delete")," "),M.a.createElement(y.a,{onClick:function(){return n.props.toggleDisableComments(!t.get("disableComments"))}},t.get("disableComments")?a("post.enableComments"):a("post.disableComments")),M.a.createElement(y.a,{onClick:function(){return n.props.toggleSharingComments(!t.get("disableSharing"))}},t.get("disableSharing")?a("post.enableSharing"):a("post.disableSharing"))))};var a=e.post;return n.state={text:a.get("body",""),readMoreState:!1,openComments:!1,shareOpen:!1,disableComments:a.get("disableComments"),disableSharing:a.get("disableSharing"),shareTitle:"Share On",openCopyLink:!1,openPostWrite:!1,postMenuAnchorEl:null,isPostMenuOpen:!1,showVideo:!1},n.handleReadMore=n.handleReadMore.bind(Object(l.a)(n)),n.getOpenCommentGroup=n.getOpenCommentGroup.bind(Object(l.a)(n)),n.handleVote=n.handleVote.bind(Object(l.a)(n)),n.handleOpenShare=n.handleOpenShare.bind(Object(l.a)(n)),n.handleCloseShare=n.handleCloseShare.bind(Object(l.a)(n)),n.handleCopyLink=n.handleCopyLink.bind(Object(l.a)(n)),n.handleDelete=n.handleDelete.bind(Object(l.a)(n)),n.handleOpenPostWrite=n.handleOpenPostWrite.bind(Object(l.a)(n)),n.handleClosePostWrite=n.handleClosePostWrite.bind(Object(l.a)(n)),n.handleOpenComments=n.handleOpenComments.bind(Object(l.a)(n)),n.rightIconMenu=n.rightIconMenu.bind(Object(l.a)(n)),n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"handleReadMore",value:function(e){this.setState({readMoreState:!this.state.readMoreState})}},{key:"shouldComponentUpdate",value:function(e,t){var n=!1;return e.post.equals(this.props.post)?e.commentList!==this.props.commentList?n=!0:this.props.getPostComments!==e.getPostComments?n=!0:U.a(this.state,t)||(n=!0):n=!0,n}},{key:"getAlbum",value:function(){var e=this.props.post,t=e.get("album"),n=e.get("id"),a=e.get("postTypeId");return t&&t.get("photos")&&(a===Ze.a.Album||a===Ze.a.PhotoGallery)?M.a.createElement(rt,{key:"post-album-grid-".concat(n),currentAlbum:e,images:t.get("photos")}):""}},{key:"render",value:function(){var e=this.props,t=e.post,n=e.setHomeTitle,o=e.goTo,i=e.isPostOwner,r=e.commentList,s=e.classes,l=this.state.showVideo,c=t.get("ownerUserId"),v=t.get("ownerDisplayName"),y=t.get("creationDate"),O=t.get("ownerAvatar"),E=t.get("image"),w=t.get("body"),j=t.get("video"),P=t.get("thumbnail"),k=t.get("postTypeId"),T=t.get("id"),N=t.get("disableComments"),R=t.get("commentCounter"),W=t.get("disableSharing"),A=t.get("score");t.get("version");return M.a.createElement(d.a,{key:T+"post-card",className:"animate-top"},M.a.createElement(m.a,{title:M.a.createElement(K.a,{to:"/".concat(c)},v),subheader:y?(mt.a.dataFormat.postVersion,$()(y).local().fromNow()+" | ".concat(this.getPermissionLabel())):M.a.createElement(b.a,{color:"primary"}),avatar:M.a.createElement(K.a,{to:"/".concat(c)},M.a.createElement(J.a,{fullName:v,fileName:O,size:36})),action:i?this.rightIconMenu():""}),E&&""!==E&&k===Ze.a.Photo||P&&""!==P&&j&&""!==j&&k===Ze.a.Video?M.a.createElement(h.a,{className:s.cardMedia,image:k===Ze.a.Photo?E:P},l?M.a.createElement("div",{className:"player-wrapper"},M.a.createElement(dt.a,{controls:!0,className:"react-player",width:"100%",height:"100%",url:j,playing:!0})):M.a.createElement(M.a.Fragment,null,M.a.createElement(xe.a,{fileName:k===Ze.a.Photo?E:P}),M.a.createElement("span",{className:D()(s.playVideo,Object(a.a)({},s.noDisplay,k!==Ze.a.Video))},M.a.createElement(f.a,{className:s.playIconButtonRoot,onClick:this.onShowVideo},M.a.createElement(I.a,{className:s.playIcon}))))):"",this.getAlbum(),M.a.createElement(u.a,{className:s.postBody},M.a.createElement(Ne,{body:w},M.a.createElement(lt.a,{properties:{target:"_blank",style:{color:"blue"},onClick:function(e){return e.stopPropagation()}}},ut()(w,/#(\w+)/g,(function(e,t){return M.a.createElement(K.a,{style:{color:"green"},key:e+t,to:"/tag/".concat(e),onClick:function(t){t.preventDefault(),t.stopPropagation(),o("/tag/".concat(e)),n("#".concat(e))}},"#",e)}))))),M.a.createElement(p.a,null,M.a.createElement("div",{className:s.vote},M.a.createElement(f.a,{className:s.iconButton,onClick:this.handleVote,"aria-label":"Love"},M.a.createElement(g.a,{className:s.iconButton,checkedIcon:M.a.createElement(x.a,{style:{fill:"#4CAF50"}}),icon:M.a.createElement(S.a,{style:{fill:"#757575"}}),checked:this.props.currentUserVote})),M.a.createElement("div",{className:s.voteCounter}," ",A>0?A:""," ")),M.a.createElement("div",{style:{display:"inherit"}},M.a.createElement(f.a,{className:s.iconButton,onClick:this.handleOpenComments,"aria-label":"Comment"},M.a.createElement(C.a,null)),M.a.createElement("div",{className:s.commentCounter},R>0?R:""," ")),W?"":M.a.createElement(f.a,{className:s.iconButton,onClick:this.handleOpenShare,"aria-label":"Comment"},M.a.createElement(L.a,null))),M.a.createElement(we,{open:this.state.openComments,comments:r,ownerPostUserId:c,onToggleRequest:this.handleOpenComments,isPostOwner:this.props.isPostOwner,disableComments:N,postId:T}),M.a.createElement(Xe,{onClose:this.handleCloseShare,shareOpen:this.state.shareOpen,onCopyLink:this.handleCopyLink,openCopyLink:this.state.openCopyLink,post:t}),this.state.openPostWrite&&M.a.createElement(je.a,{key:"post-component-post-write-".concat(T),open:this.state.openPostWrite,onRequestClose:this.handleClosePostWrite,edit:!0,postModel:t}))}}]),t}(W.Component),jt=Object(te.c)("translations")(xt),St=(Ie=Object(O.a)((function(e){return{iconButton:{},vote:{display:"flex",flex:1},voteCounter:{color:"#777",fontSize:12,fontWeight:500,marginTop:25,marginLeft:-18,marginRight:6},commentCounter:{fontWeight:400,color:"#777",fontSize:12,lineHeight:"48px",marginLeft:-2},popperOpen:{zIndex:10},popperClose:{pointerEvents:"none",zIndex:0},postBody:{wordWrap:"break-word",color:"rgba(0, 0, 0, 0.87)",fontSize:"0.875rem",fontWeight:400,fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif',lineHeight:"1.46429em",whiteSpace:"pre-line"},image:{width:"100%",height:500},playVideo:{position:"absolute",right:"45%",top:"45%",cursor:"pointer",backgroundColor:"#f1efeca3",borderRadius:"50%",height:60,padding:0},playIcon:{width:60,height:60,marginTop:"-12px",fill:"red"},noDisplay:{display:"none"},playIconButtonRoot:{width:60,height:60},cardMedia:{position:"relative"},fullPageXs:Object(a.a)({},e.breakpoints.down("xs"),{width:"100%",height:"100%",margin:0,overflowY:"auto"})}}))(jt),Object(ee.connect)(wt,Ct)(Ie));t.a=St},607:function(e,t,n){"use strict";var a,o=n(8),i=n(49),r=n(45),s=n(86),l=n(43),c=n(48),d=n(177),p=n(528),u=n(1113),m=n(530),h=n(308),g=n(292),f=n.n(g),b=n(571),v=n.n(b),y=function(e){return e.reduce((function(e,t,n,a){return t<a[e]?n:e}),0)},O=function(e){for(var t=[],n=0;n<e;n++)t.push(0);return t},E=n(50),C=n(154),w=n.n(C),x=n(204),j=n(4),S=n(597),P=n.n(S),k=n(0),T=n.n(k),I=n(599),N=n.n(I),L=n(106),R=n(554),D=n(95),W=n(592),M=n(569),A=n(202),U=n(551),z=n(19),B=n(181),V=n(61),F=n(5),q=n(39),G=n(133),Y=n(539),H=function(e,t){return{openPostWrite:function(){return e(F.openDialog(B.a.PostWrite))},closePostWrite:function(){return e(F.closeDialog(B.a.PostWrite))},showTopLoading:function(){return e(F.showTopLoading())},hideTopLoading:function(){return e(F.hideTopLoading())}}},_=function(){var e=q.a.selectCurrentUser(),t=G.a.selectDialogState(),n=G.a.selectProgress(),a=Y.a.selectRequest();return function(o,i){var r=e(o),s=t(o,{type:B.a.PostWrite}),l=a(o,{requestId:i.requestId}),c=n(o);return{streamRequestStatus:l?l.status:z.a.NoAction,avatar:r.get("avatar",""),fullName:r.get("fullName"),postWriteDilogOpen:s,progress:c}}},X=n(15),J=function(e,t){return e>1400?Q(3,t):e<867?Q(1,t):e<1400?Q(2,t):[]},Q=function(e,t){var n=[],a=0,o=O(e);return t.forEach((function(e,t){n[a]||(n[a]=[]),n[a].push(e),++o[a],e.get("postTypeId")!==x.a.Text&&++o[a];var i=e.get("body");o[a]+=Number(E.a.getNumberOfLines(i)/10),a=y(o)})),n},$=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(i.a)(this,Object(r.a)(t).call(this,e))).nextPage=0,n.styles={postWritePrimaryText:{color:d.a[400],cursor:"text"},postWtireItem:{fontWeight:"200"}},n.loader=function(){var e=n.props.streamRequestStatus;e&&e!==z.a.Sent&&((0,n.props.loadStream)(n.nextPage),n.nextPage++)},n.handleResize=function(e){var t=n.props.posts,a=J(e.target.innerWidth,t);n.setState({posts:a})},n.handleOpenPostWrite=function(){var e=n.props.openPostWrite;e&&e()},n.handleClosePostWrite=function(){var e=n.props.closePostWrite;e&&e()},n.writePostElement=function(){var e=n.props,t=e.tag,a=e.displayWriting,o=e.classes,i=e.t,r=e.postWriteDilogOpen;return T.a.createElement("div",{className:w()("grid-cell animate-top",o.gridCell),style:{maxWidth:"530px",minWidth:"280px"}},r&&T.a.createElement(M.a,{open:r,onRequestClose:n.handleClosePostWrite,edit:!1}),a&&!t?T.a.createElement(T.a.Fragment,null,T.a.createElement(h.a,{elevation:2},T.a.createElement(p.a,{button:!0,style:n.styles.postWtireItem,onClick:n.handleOpenPostWrite},T.a.createElement(A.a,{fullName:n.props.fullName,fileName:n.props.avatar,size:36}),T.a.createElement(m.a,{inset:!0,primary:T.a.createElement("span",{style:n.styles.postWritePrimaryText}," ",i("home.postWriteButtonText"))}),T.a.createElement(u.a,null,T.a.createElement(v.a,null)))),T.a.createElement("div",{style:{height:"16px"}})):"")},n.getpostList=function(){var e=n.props.classes,t=n.state.posts,a=[];return(t||[]).forEach((function(t,o){var i=T.a.createElement("div",{className:e.postBox,key:"post-stream-column-".concat(o)},0===o?n.writePostElement():"",t.map((function(t,n){return T.a.createElement(k.Fragment,{key:"post-container-".concat(t.get("id"))},n>0?T.a.createElement("div",{className:e.spaceBox}," "):"",T.a.createElement(W.a,{key:"".concat(t.get("id"),"-stream-div-post"),post:t})," ")})));a.push(i)})),a},n.state={divided:!1,disableComments:n.props.disableComments,disableSharing:n.props.disableSharing,openPostWrite:!1,homeTitle:e.homeTitle,hasMorePosts:!0,posts:[],prevPosts:Object(j.Map)({})},n.handleResize=P()(n.handleResize,300),n.handleResize=n.handleResize.bind(Object(s.a)(n)),n.loader=n.loader.bind(Object(s.a)(n)),n.handleOpenPostWrite=n.handleOpenPostWrite.bind(Object(s.a)(n)),n.handleClosePostWrite=n.handleClosePostWrite.bind(Object(s.a)(n)),n}return Object(c.a)(t,e),Object(l.a)(t,null,[{key:"getDerivedStateFromProps",value:function(e,t){return e.posts&&e.posts.count()>0&&!e.posts.equals(t.prevPosts)?{posts:J(window.innerWidth,e.posts),prevPosts:e.posts.count()}:null}}]),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){e.loader()}),500)}},{key:"render",value:function(){var e=this.props,t=e.hasMorePosts,n=e.classes,a=e.posts;return T.a.createElement(R.a,{dataLength:a?a.size:0,next:this.loader,hasMore:t,endMessage:"",loader:T.a.createElement(U.a,{key:"stream-load-more-progress"})},T.a.createElement(N.a,{target:"window",onResize:this.handleResize}),!a||a.count()>0?"":this.writePostElement(),T.a.createElement("div",{className:n.container},a&&a.count()>0&&this.getpostList()))}}]),t}(k.Component),Z=Object(L.c)("translations")($),K=Object(D.withRouter)((a=f()((function(e){var t;return{root:{position:"relative"},container:(t={maxWidth:1200,textAlign:"center",whiteSpace:"nowrap",lineHeight:0,position:"relative",boxPack:"center",WebkitJustifyContent:"center",justifyContent:"center",display:"flex",margin:"0 auto",padding:"10px 0",width:"100%"},Object(X.a)(t,"@media (min-width: 440px)",{width:"90%"}),Object(X.a)(t,"@media only screen and (min-width: 860px)",{width:"90%"}),Object(X.a)(t,"@media (min-width: 1600px)",{width:"94%"}),Object(X.a)(t,"@media (max-width: 440px)",{width:"calc(100% - 16px)",margin:"0 8px"}),t),postBox:Object(X.a)({flexGrow:1,WebkitBoxFlex:1,flex:"0 1 auto",maxWidth:530,minWidth:140,width:"100%",display:"inline-block",verticalAlign:"top",textAlign:"left",whiteSpace:"normal",lineHeight:"normal"},"& + &",{marginLeft:24}),spaceBox:{height:24},gridCell:Object(X.a)({},e.breakpoints.down("sm"),{maxWidth:"100% !important",width:"100%"})}}))(Z),Object(V.connect)(_,H)(a)));t.a=K},631:function(e,t,n){"use strict";var a=n(520),o=n(134),i=Object(a.b)({defaultTheme:o.a});t.a=i},633:function(e,t,n){"use strict";n.r(t);var a=n(8),o=n(43),i=n(49),r=n(45),s=n(48),l=n(1122),c=n(292),d=n.n(c),p=n(1145),u=n(1149),m=n(179),h=n(0),g=n.n(h),f=n(106),b=n(61),v=n(95),y=n(5),O=function(e){function t(e){var n;Object(a.a)(this,t),(n=Object(i.a)(this,Object(r.a)(t).call(this,e))).handleChangeTab=function(e,t){var a=n.props,o=a.goTo,i=a.setHeaderTitle,r=a.t,s=a.location;switch(n.setState({tabIndex:t}),t){case 0:o("/search/post".concat(s.search)),i(r("header.peopleCaption"));break;case 1:o("/search/user".concat(s.search)),i(r("header.circlesCaption"))}},n.getTabIndexByNav=function(e){switch(e){case"people":return 1;default:return 0}};var o=n.props.tab;return n.state={tabIndex:n.getTabIndexByNav(o)},n}return Object(s.a)(t,e),Object(o.a)(t,[{key:"componentWillMount",value:function(){var e=this.props,t=e.setHeaderTitle,n=e.t;switch(this.props.match.params.tab){case void 0:case"":t(n("header.peopleCaption"));break;case"circles":t(n("header.circlesCaption"));break;case"followers":t(n("header.followersCaption"))}}},{key:"render",value:function(){var e=this.props,t=e.t,n=e.children,a=e.classes,o=this.state.tabIndex;return g.a.createElement("div",{style:{margin:"0 auto"}},g.a.createElement(l.a,{position:"static",color:"default"},g.a.createElement(u.a,{indicatorColor:"secondary",onChange:this.handleChangeTab,value:o,centered:!0,textColor:"primary"},g.a.createElement(p.a,{label:t("search.posts")}),g.a.createElement(p.a,{label:t("search.users")}))),g.a.createElement("div",{className:a.container},n))}}]),t}(h.Component),E=Object(f.c)("translations")(O),C=Object(v.withRouter)(Object(b.connect)((function(e,t){return{uid:e.getIn(["authorize","uid"],0),circlesLoaded:e.getIn(["circle","loaded"])}}),(function(e,t){return{goTo:function(t){return e(Object(m.a)(t))},setHeaderTitle:function(t){return e(y.setHeaderTitle(t))}}}))(d()((function(e){return{container:{marginTop:50}}}))(E)));t.default=C}}]);